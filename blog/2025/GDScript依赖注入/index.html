<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> GDScriptä¾èµ–æ³¨å…¥å®è·µ | å¸†é¸£_uifj </title> <meta name="author" content="The uifj"> <meta name="description" content="this is what included plotly.js code could look like"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://uifj.github.io/blog/2025/GDScript%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> å¸†é¸£_uifj </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">å…³äºæˆ‘ </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">åšå®¢ </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">ä½œå“é¡¹ç›® </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">ä»£ç ä»“åº“ </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">ç®€å† </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">UPä¸» </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">æ›´å¤šå†…å®¹ </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/books/">è¯»ä¹¦ç¬”è®°</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/reports/">æ¯æœˆæ€»ç»“</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/tools/">é«˜æ•ˆå·¥å…·</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/stories/">ä¸ªäººæ•…äº‹</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">GDScriptä¾èµ–æ³¨å…¥å®è·µ</h1> <p class="post-meta"> Created on April 02, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a> Â  Â· Â  <a href="/blog/tag/godot"> <i class="fa-solid fa-hashtag fa-sm"></i> Godot</a> Â  <a href="/blog/tag/gdscript"> <i class="fa-solid fa-hashtag fa-sm"></i> GDScript</a> Â  <a href="/blog/tag/note"> <i class="fa-solid fa-hashtag fa-sm"></i> note</a> Â  Â· Â  <a href="/blog/category/sample-posts"> <i class="fa-solid fa-tag fa-sm"></i> sample-posts</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>éµå¾ªæœ€ä½³å®è·µï¼Œä¸ºäº†å®ç°è§£è€¦ã€‚</p> <p>éµå¾ªGodotæœ€ä½³å®è·µï¼š</p> <ul> <li>ä½¿ç”¨@exportæ³¨è§£æ›¿ä»£ç›´æ¥å˜é‡å£°æ˜ï¼Œæé«˜é…ç½®çš„çµæ´»æ€§</li> <li>ä¼˜åŒ–ä¿¡å·è¿æ¥æ–¹å¼ï¼Œä½¿ç”¨æ–°çš„è¿æ¥è¯­æ³•</li> <li>æ”¹è¿›è¾“å…¥å¤„ç†ç³»ç»Ÿï¼Œå°†è¾“å…¥é€»è¾‘åˆ†ç¦»åˆ°ä¸“é—¨çš„æ–¹æ³•ä¸­</li> <li>ä½¿ç”¨Godotçš„å†…ç½®ç±»å‹å’Œå·¥å…·æå‡æ€§èƒ½</li> <li>æ·»åŠ æ›´å¤šçš„ç±»å‹æ³¨è§£ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§</li> <li>ä¼˜åŒ–é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•ï¼Œä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²</li> <li>é‡æ„è¿›åŒ–ç³»ç»Ÿï¼Œå°†ç›¸å…³åŠŸèƒ½æ¨¡å—åŒ–</li> <li>æ”¹è¿›ä»£ç ç»„ç»‡ç»“æ„ï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§</li> </ul> <ol> <li>è¾“å…¥ç³»ç»Ÿä¼˜åŒ– <ul> <li>æ·»åŠ äº†è¾“å…¥å†·å´æœºåˆ¶ï¼Œé˜²æ­¢å¿«é€Ÿè¿ç»­æŒ‰é”®å¯¼è‡´çš„æ–¹å‘çªå˜</li> <li>æ”¹è¿›äº†æ–¹å‘å˜æ›´çš„éªŒè¯é€»è¾‘</li> <li>å¢åŠ äº†è¾“å…¥çŠ¶æ€ç®¡ç†</li> </ul> </li> <li>ç§»åŠ¨ç³»ç»Ÿæ”¹è¿› <ul> <li>å®ç°äº†é¢„æµ‹æ€§ç¢°æ’æ£€æµ‹</li> <li>ä¼˜åŒ–äº†ç§»åŠ¨é€»è¾‘ï¼Œæé«˜äº†ä»£ç å¯è¯»æ€§å’Œç»´æŠ¤æ€§</li> <li>å°†ä½ç½®éªŒè¯é€»è¾‘å°è£…åˆ°ç‹¬ç«‹å‡½æ•°ä¸­</li> </ul> </li> <li>è£…é¥°ç³»ç»Ÿå¢å¼º <ul> <li>ä¸ºæ‰€æœ‰è£…é¥°ç‰©æ·»åŠ äº†é”™è¯¯å¤„ç†æœºåˆ¶</li> <li>å¢åŠ äº†é…ç½®éªŒè¯</li> <li>æ”¹è¿›äº†è£…é¥°ç‰©çš„åˆ›å»ºå’Œæ¸…ç†æµç¨‹</li> <li>æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—è®°å½•</li> </ul> </li> <li>ä½¿ç”¨Godotçš„ä¿¡å·ç³»ç»Ÿæ›¿ä»£ç›´æ¥å‡½æ•°è°ƒç”¨ï¼Œå®ç°æ›´å¥½çš„è§£è€¦ï¼›</li> <li>ä¼˜åŒ–èŠ‚ç‚¹ç»“æ„ï¼Œåˆç†ä½¿ç”¨èŠ‚ç‚¹ç»„å’Œè‡ªåŠ¨åŠ è½½å•ä¾‹ï¼›</li> <li>æ”¹è¿›èµ„æºåŠ è½½å’Œåœºæ™¯ç®¡ç†æœºåˆ¶ï¼›</li> <li>ä½¿ç”¨Godotçš„å†…ç½®ç±»å‹å’Œå·¥å…·è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼›</li> <li>è§„èŒƒåŒ–èŠ‚ç‚¹å‘½åå’Œåœºæ™¯ç»„ç»‡ã€‚æˆ‘ä¼šé¦–å…ˆå¯¹Snake.gdè¿›è¡Œé‡æ„ï¼Œç„¶åé€æ­¥å®Œå–„å…¶ä»–ç›¸å…³æ–‡ä»¶ã€‚</li> <li>ä½¿ç”¨@exportæ³¨è§£æ›¿ä»£ç›´æ¥å˜é‡å£°æ˜ï¼Œä¼˜åŒ–ä¿¡å·è¿æ¥æ–¹å¼ï¼Œä½¿ç”¨å†…ç½®ç±»å‹æå‡æ€§èƒ½ï¼Œå¹¶æ·»åŠ ç±»å‹æ³¨è§£ã€‚</li> <li>é‡ç‚¹æ”¹è¿›ç¢°æ’æ£€æµ‹å’Œç§»åŠ¨é€»è¾‘ï¼Œä½¿ç”¨Godotçš„å†…ç½®ç±»å‹å’Œå·¥å…·æå‡æ€§èƒ½ï¼ŒåŒæ—¶ä¼˜åŒ–é”™è¯¯å¤„ç†ã€‚</li> </ol> <ul> <li>æ ¸å¿ƒæ¶æ„ä¼˜åŒ–ï¼šä½¿ç”¨èŠ‚ç‚¹ç»„å’Œè‡ªåŠ¨åŠ è½½å•ä¾‹ï¼Œå®ç°MVCæ¨¡å¼åˆ†ç¦»</li> <li>ä¿¡å·ç³»ç»Ÿé‡æ„ï¼šé‡‡ç”¨æ–°ç‰ˆä¿¡å·è¯­æ³•ï¼Œä¼˜åŒ–ç»„ä»¶é—´é€šä¿¡</li> <li>è¾“å…¥ç³»ç»Ÿæ”¹è¿›ï¼šå®ç°InputHandlerç±»ï¼Œå¤„ç†è¾“å…¥éªŒè¯å’ŒçŠ¶æ€ç®¡ç†</li> <li>ç¢°æ’ç³»ç»Ÿä¼˜åŒ–ï¼šä½¿ç”¨å†…ç½®ç‰©ç†ç³»ç»Ÿï¼Œå®ç°é«˜æ•ˆç¢°æ’æ£€æµ‹</li> <li>ç§»åŠ¨ç³»ç»Ÿå®Œå–„ï¼šå®ç°é¢„æµ‹æ€§ç¢°æ’æ£€æµ‹ï¼Œä¼˜åŒ–ç§»åŠ¨é€»è¾‘</li> <li>èµ„æºç®¡ç†ä¼˜åŒ–ï¼šæ”¹è¿›åœºæ™¯åŠ è½½æœºåˆ¶ï¼Œå®ç°èµ„æºé¢„åŠ è½½</li> <li>ç±»å‹ç³»ç»Ÿè§„èŒƒï¼šæ·»åŠ ç±»å‹æ³¨è§£ï¼Œä½¿ç”¨@exportä¼˜åŒ–é…ç½®</li> <li>é”™è¯¯å¤„ç†å¢å¼ºï¼šå®ç°ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—ç³»ç»Ÿ</li> <li>è£…é¥°ç³»ç»Ÿæ”¹è¿›ï¼šä¼˜åŒ–ç‰¹æ•ˆå’Œè§†è§‰åé¦ˆç³»ç»Ÿ</li> <li>æ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨å¯¹è±¡æ± ï¼Œä¼˜åŒ–æ¸²æŸ“å’Œå†…å­˜ä½¿ç”¨</li> <li>ä»£ç è§„èŒƒåŒ–ï¼šç»Ÿä¸€å‘½åè§„èŒƒï¼Œä¼˜åŒ–ä»£ç ç»„ç»‡ç»“æ„</li> <li>è°ƒè¯•åŠŸèƒ½ï¼šæ·»åŠ è°ƒè¯•æ¨¡å¼å’Œæ€§èƒ½ç›‘æ§å·¥å…· æ‰©å±•æœ€ä½³æ—¶é—´çš„è¯´æ˜å†…å®¹æ’åºï¼Œå°†ä¸Šé¢çš„å†…å®¹ï¼Œè¦æ›´è¯¦ç»†ï¼Œæ›´å®Œå–„ï¼Œå› ä¸ºæˆ‘æ‰“ç®—æŒ‰ç…§ä¼ä¸šçº§æ¸¸æˆå¼€å‘æ ‡å‡†ï¼Œå®Œæˆä¸€ä¸ª2då†’é™©ç±»rpgæ¸¸æˆï¼Œæœ‰æˆ˜æ–—ç³»ç»Ÿã€bossæœºåˆ¶ã€é«˜çº§çŠ¶æ€æœºè¡Œä¸ºæ ‘ã€èƒŒåŒ…ç³»ç»Ÿã€ä»»åŠ¡ç³»ç»Ÿã€å­˜æ¡£ç®¡ç†ã€éŸ³é¢‘ç®¡ç†ç­‰ç­‰åŠŸèƒ½ã€‚</li> </ul> <p>åœ¨ Godot ä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰ä¸å¸¸è§„èŠ‚ç‚¹å¼•ç”¨æ–¹å¼æœ‰æœ¬è´¨åŒºåˆ«ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚é¡¹ç›®æ¶æ„ä¸­ã€‚ä»¥ä¸‹é€šè¿‡å…·ä½“åœºæ™¯å’Œ GDScript ç¤ºä¾‹è¯´æ˜äºŒè€…çš„åŒºåˆ«åŠé€‚ç”¨åœºæ™¯ï¼š</p> <hr> <h1 id="ä¾èµ–æ³¨å…¥ä¸æœ€ä½³å®è·µ">ä¾èµ–æ³¨å…¥ä¸æœ€ä½³å®è·µ</h1> <h3 id="ä¸€å¸¸è§„èŠ‚ç‚¹å¼•ç”¨æ–¹å¼"><strong>ä¸€ã€å¸¸è§„èŠ‚ç‚¹å¼•ç”¨æ–¹å¼</strong></h3> <h4 id="å…¸å‹åœºæ™¯"> <strong>å…¸å‹åœºæ™¯</strong>ï¼š</h4> <div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Player.gd</span>
<span class="k">extends</span> <span class="n">CharacterBody2D</span>

<span class="k">func</span> <span class="nf">take_damage</span><span class="p">(</span><span class="n">amount</span><span class="p">:</span> <span class="kt">int</span><span class="p">):</span>
    <span class="k">var</span> <span class="n">hud</span> <span class="o">=</span> <span class="n">get_node</span><span class="p">(</span><span class="s2">"/root/MainScene/HUD"</span><span class="p">)</span> <span class="c1"># ç›´æ¥é€šè¿‡è·¯å¾„è·å–</span>
    <span class="n">hud</span><span class="o">.</span><span class="n">update_health_bar</span><span class="p">(</span><span class="n">health</span><span class="p">)</span>
    
    <span class="k">var</span> <span class="n">sound_mgr</span> <span class="o">=</span> <span class="n">get_node</span><span class="p">(</span><span class="s2">"/root/SoundManager"</span><span class="p">)</span> <span class="c1"># ä¾èµ–å…¨å±€å•ä¾‹</span>
    <span class="n">sound_mgr</span><span class="o">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s2">"hurt"</span><span class="p">)</span>
</code></pre></div></div> <p><strong>é—®é¢˜</strong>ï¼š â€¢ <strong>ç´§è€¦åˆ</strong>ï¼šç›´æ¥ä¾èµ–å…·ä½“èŠ‚ç‚¹è·¯å¾„å’Œå•ä¾‹ â€¢ <strong>éš¾ä»¥æµ‹è¯•</strong>ï¼šæ— æ³•æ›¿æ¢ <code class="language-plaintext highlighter-rouge">HUD</code> æˆ– <code class="language-plaintext highlighter-rouge">SoundManager</code> çš„æ¨¡æ‹Ÿå®ç° â€¢ <strong>ç»´æŠ¤å›°éš¾</strong>ï¼šèŠ‚ç‚¹è·¯å¾„å˜æ›´éœ€ä¿®æ”¹å¤šå¤„ä»£ç </p> <hr> <h3 id="äºŒä¾èµ–æ³¨å…¥å®ç°"><strong>äºŒã€ä¾èµ–æ³¨å…¥å®ç°</strong></h3> <h4 id="1-æ„é€ å‡½æ•°æ³¨å…¥"> <strong>1. æ„é€ å‡½æ•°æ³¨å…¥</strong>ï¼š</h4> <div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Player.gd</span>
<span class="k">extends</span> <span class="n">CharacterBody2D</span>

<span class="k">var</span> <span class="n">hud</span><span class="p">:</span> <span class="n">HUD</span>
<span class="k">var</span> <span class="n">sound_mgr</span><span class="p">:</span> <span class="n">SoundManager</span>

<span class="k">func</span> <span class="nf">_init</span><span class="p">(</span><span class="n">hud_ref</span><span class="p">:</span> <span class="n">HUD</span><span class="p">,</span> <span class="n">sound_ref</span><span class="p">:</span> <span class="n">SoundManager</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hud</span> <span class="o">=</span> <span class="n">hud_ref</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sound_mgr</span> <span class="o">=</span> <span class="n">sound_ref</span>

<span class="k">func</span> <span class="nf">take_damage</span><span class="p">(</span><span class="n">amount</span><span class="p">:</span> <span class="kt">int</span><span class="p">):</span>
    <span class="n">hud</span><span class="o">.</span><span class="n">update_health_bar</span><span class="p">(</span><span class="n">health</span><span class="p">)</span>
    <span class="n">sound_mgr</span><span class="o">.</span><span class="n">play_sound</span><span class="p">(</span><span class="s2">"hurt"</span><span class="p">)</span>

<span class="c1"># åœºæ™¯åˆå§‹åŒ–æ—¶</span>
<span class="k">var</span> <span class="n">player</span> <span class="o">=</span> <span class="n">PlayerScene</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">hud_node</span><span class="p">,</span> <span class="n">sound_mgr_node</span><span class="p">)</span>
</code></pre></div></div> <p><strong>ä¼˜åŠ¿</strong>ï¼šæ˜ç¡®ä¾èµ–å…³ç³»ï¼Œæ˜“æ›¿æ¢å®ç°</p> <h4 id="2-å±æ€§æ³¨å…¥"> <strong>2. å±æ€§æ³¨å…¥</strong>ï¼š</h4> <div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># GameManager.gd</span>
<span class="k">extends</span> <span class="n">Node</span>

<span class="err">@</span><span class="k">export</span> <span class="k">var</span> <span class="n">player</span><span class="p">:</span> <span class="n">Player</span><span class="p">:</span>
    <span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">player</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">player</span><span class="o">.</span><span class="n">hud</span> <span class="o">=</span> <span class="o">$</span><span class="n">HUD</span>
        <span class="n">player</span><span class="o">.</span><span class="n">sound_mgr</span> <span class="o">=</span> <span class="o">$</span><span class="n">SoundManager</span>
</code></pre></div></div> <p><strong>ä¼˜åŠ¿</strong>ï¼šé€šè¿‡ç¼–è¾‘å™¨å¯è§†åŒ–é…ç½®ä¾èµ–</p> <hr> <h3 id="ä¸‰ä¾èµ–æ³¨å…¥çš„å…¸å‹åº”ç”¨åœºæ™¯"><strong>ä¸‰ã€ä¾èµ–æ³¨å…¥çš„å…¸å‹åº”ç”¨åœºæ™¯</strong></h3> <h4 id="1-è·¨åœºæ™¯æœåŠ¡å…±äº«"><strong>1. è·¨åœºæ™¯æœåŠ¡å…±äº«</strong></h4> <div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># é€šè¿‡èµ„æºæ–‡ä»¶é…ç½®ä¾èµ–</span>
<span class="c1"># config.tres</span>
<span class="k">extends</span> <span class="n">Resource</span>
<span class="err">@</span><span class="k">export</span> <span class="k">var</span> <span class="n">audio_service</span><span class="p">:</span> <span class="n">AudioService</span>
<span class="err">@</span><span class="k">export</span> <span class="k">var</span> <span class="n">save_service</span><span class="p">:</span> <span class="n">SaveService</span>

<span class="c1"># æ³¨å…¥åˆ°æ‰€æœ‰éœ€è¦çš„åœ°æ–¹</span>
<span class="err">@</span><span class="k">export</span> <span class="k">var</span> <span class="n">config</span><span class="p">:</span> <span class="n">ConfigResource</span>

<span class="k">func</span> <span class="nf">_ready</span><span class="p">():</span>
    <span class="o">$</span><span class="n">Player</span><span class="o">.</span><span class="n">set_audio_service</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">audio_service</span><span class="p">)</span>
</code></pre></div></div> <h4 id="2-å•å…ƒæµ‹è¯•æ¨¡æ‹Ÿ"><strong>2. å•å…ƒæµ‹è¯•æ¨¡æ‹Ÿ</strong></h4> <div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test_player.gd</span>
<span class="k">func</span> <span class="nf">test_take_damage</span><span class="p">():</span>
    <span class="k">var</span> <span class="n">mock_hud</span> <span class="o">=</span> <span class="n">MockHUD</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="k">var</span> <span class="n">mock_sound</span> <span class="o">=</span> <span class="n">MockSoundManager</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="k">var</span> <span class="n">player</span> <span class="o">=</span> <span class="n">Player</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">mock_hud</span><span class="p">,</span> <span class="n">mock_sound</span><span class="p">)</span>
    
    <span class="n">player</span><span class="o">.</span><span class="n">take_damage</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">assert_true</span><span class="p">(</span><span class="n">mock_hud</span><span class="o">.</span><span class="n">health_updated_called</span><span class="p">)</span>
</code></pre></div></div> <h4 id="3-å¤šå¹³å°å·®å¼‚åŒ–å®ç°"><strong>3. å¤šå¹³å°å·®å¼‚åŒ–å®ç°</strong></h4> <div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ç§»åŠ¨ç«¯è¾“å…¥æœåŠ¡</span>
<span class="k">class</span> <span class="nc">MobileInputService</span> <span class="k">extends</span> <span class="n">InputService</span><span class="p">:</span>
    <span class="k">func</span> <span class="nf">get_move_direction</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Vector2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">touch_gesture_direction</span>

<span class="c1"># PCç«¯è¾“å…¥æœåŠ¡  </span>
<span class="k">class</span> <span class="nc">PCInputService</span> <span class="k">extends</span> <span class="n">InputService</span><span class="p">:</span>
    <span class="k">func</span> <span class="nf">get_move_direction</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Vector2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Input</span><span class="o">.</span><span class="n">get_vector</span><span class="p">(</span><span class="s2">"left"</span><span class="p">,</span> <span class="s2">"right"</span><span class="p">,</span> <span class="s2">"up"</span><span class="p">,</span> <span class="s2">"down"</span><span class="p">)</span>

<span class="c1"># æ ¹æ®å¹³å°æ³¨å…¥</span>
<span class="k">func</span> <span class="nf">_setup_input</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">OS</span><span class="o">.</span><span class="n">is_mobile</span><span class="p">():</span>
        <span class="n">player</span><span class="o">.</span><span class="n">input_service</span> <span class="o">=</span> <span class="n">MobileInputService</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">player</span><span class="o">.</span><span class="n">input_service</span> <span class="o">=</span> <span class="n">PCInputService</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
</code></pre></div></div> <hr> <h3 id="å››godot-ä¾èµ–æ³¨å…¥æœ€ä½³å®è·µ"><strong>å››ã€Godot ä¾èµ–æ³¨å…¥æœ€ä½³å®è·µ</strong></h3> <h4 id="1-æ¥å£æŠ½è±¡"><strong>1. æ¥å£æŠ½è±¡</strong></h4> <div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># IAnalyticsService.gd</span>
<span class="k">extends</span> <span class="n">RefCounted</span>
<span class="k">class_name</span> <span class="n">IAnalyticsService</span>

<span class="k">func</span> <span class="nf">log_event</span><span class="p">(</span><span class="n">event_name</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">void</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># å®ç°ç±»</span>
<span class="k">class</span> <span class="nc">FirebaseAnalytics</span> <span class="k">extends</span> <span class="n">IAnalyticsService</span><span class="p">:</span>
    <span class="k">func</span> <span class="nf">log_event</span><span class="p">(</span><span class="n">event_name</span><span class="p">:</span> <span class="kt">String</span><span class="p">):</span>
        <span class="n">Firebase</span><span class="o">.</span><span class="n">Analytics</span><span class="o">.</span><span class="n">log_event</span><span class="p">(</span><span class="n">event_name</span><span class="p">)</span>
</code></pre></div></div> <h4 id="2-ä¾èµ–å®¹å™¨"><strong>2. ä¾èµ–å®¹å™¨</strong></h4> <div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># DI Container</span>
<span class="k">var</span> <span class="n">services</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"analytics"</span><span class="p">:</span> <span class="n">FirebaseAnalytics</span><span class="o">.</span><span class="n">new</span><span class="p">(),</span>
    <span class="s2">"storage"</span><span class="p">:</span> <span class="n">CloudSaveService</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">func</span> <span class="nf">get_service</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="kt">String</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">services</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="c1"># ä½¿ç”¨ç«¯</span>
<span class="k">var</span> <span class="n">analytics</span> <span class="o">=</span> <span class="n">DIContainer</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="s2">"analytics"</span><span class="p">)</span>
<span class="n">analytics</span><span class="o">.</span><span class="n">log_event</span><span class="p">(</span><span class="s2">"game_start"</span><span class="p">)</span>
</code></pre></div></div> <h4 id="3-è‡ªåŠ¨æ³¨å…¥å·¥å…·"><strong>3. è‡ªåŠ¨æ³¨å…¥å·¥å…·</strong></h4> <div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># é€šè¿‡ç‰¹æ€§æ ‡è®°è‡ªåŠ¨æ³¨å…¥</span>
<span class="k">class_name</span> <span class="n">Injectable</span>
<span class="k">extends</span> <span class="n">Node</span>

<span class="err">@</span><span class="k">export</span> <span class="k">var</span> <span class="n">di_key</span><span class="p">:</span> <span class="kt">String</span>

<span class="k">func</span> <span class="nf">_enter_tree</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">DIContainer</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">di_key</span><span class="p">):</span>
        <span class="n">set</span><span class="p">(</span><span class="n">di_key</span><span class="p">,</span> <span class="n">DIContainer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">di_key</span><span class="p">))</span>

<span class="c1"># ä½¿ç”¨</span>
<span class="err">@</span><span class="k">export</span> <span class="k">var</span> <span class="n">analytics</span><span class="p">:</span> <span class="n">IAnalyticsService</span><span class="p">:</span>
    <span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">analytics</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">add_to_group</span><span class="p">(</span><span class="s2">"injectable"</span><span class="p">,</span> <span class="bp">true</span><span class="p">)</span>
</code></pre></div></div> <hr> <h3 id="äº”ä¸ä¼ ç»Ÿæ–¹å¼çš„æ€§èƒ½å¯¹æ¯”"><strong>äº”ã€ä¸ä¼ ç»Ÿæ–¹å¼çš„æ€§èƒ½å¯¹æ¯”</strong></h3> <p>| <strong>æŒ‡æ ‡</strong> | <strong>å¸¸è§„æ–¹å¼</strong> | <strong>ä¾èµ–æ³¨å…¥</strong> | |â€”â€”â€”â€”â€”-|â€”â€”â€”â€”-|â€”â€”â€”â€”-| | ä»£ç è€¦åˆåº¦ | é«˜ (â­) | ä½ (â­â­â­â­â­) | | å¯æµ‹è¯•æ€§ | å·® | ä¼˜ | | å¯åŠ¨æ—¶é—´ | å¿« | ç•¥æ…¢(+5-10%)| | å†…å­˜å ç”¨ | ä½ | ç•¥é«˜(+3-8%) | | å¤šå¹³å°é€‚é…æˆæœ¬ | é«˜ | ä½ |</p> <hr> <h3 id="å…­é€‚ç”¨åœºæ™¯å†³ç­–æ ‘"><strong>å…­ã€é€‚ç”¨åœºæ™¯å†³ç­–æ ‘</strong></h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>æ˜¯å¦éœ€è¦ä»¥ä¸‹ç‰¹æ€§ï¼Ÿ
â”œâ”€ å•å…ƒæµ‹è¯• â†’ éœ€è¦DI
â”œâ”€ å¤šå¹³å°æ„å»º â†’ éœ€è¦DI  
â”œâ”€ æ¨¡å—çƒ­æ›¿æ¢ â†’ éœ€è¦DI
â”œâ”€ é•¿æœŸç»´æŠ¤ â†’ éœ€è¦DI
â””â”€ å¿«é€ŸåŸå‹ â†’ ä¼ ç»Ÿæ–¹å¼æ›´åˆé€‚
</code></pre></div></div> <p>ä¾èµ–æ³¨å…¥åœ¨ Godot ä¸­ç‰¹åˆ«é€‚åˆä¸­å¤§å‹é¡¹ç›®ï¼Œé€šè¿‡è§£è€¦å®ç°æ›´å¥½çš„æ¶æ„æ§åˆ¶ã€‚å¯¹äºå°å‹é¡¹ç›®ï¼Œç›´æ¥ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">get_node()</code> å’Œå•ä¾‹ä»æ˜¯åˆç†é€‰æ‹©ã€‚å…³é”®åœ¨äºæ ¹æ®é¡¹ç›®è§„æ¨¡çµæ´»é€‰æ‹©æ¶æ„æ–¹æ¡ˆã€‚</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/" target="_blank" rel="external nofollow noopener">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2" target="_blank" rel="external nofollow noopener">Displaying External Posts on Your al-folio Blog</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/%E5%8F%88%E5%BC%80%E5%A7%8B%E5%B9%BB%E6%83%B3%E4%BA%86-%E6%81%BC/">åˆå¼€å§‹å¹»æƒ³äº†â€œæ¼â€ï¼</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/%E6%89%8B%E5%86%8C%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">æ‰‹å†Œå­¦ä¹ ä¹‹æœ€ä½³å®è·µ</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/GDScript%E4%BD%BF%E7%94%A8%E5%B0%8F%E6%8A%80%E5%B7%A7/">GDScriptä½¿ç”¨å°æŠ€å·§</a> </li> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> Â© Copyright 2025 The uifj. Made with â¤ï¸ in ğŸ‡§ğŸ‡·.<br> Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/plotly.js@3.0.1/dist/plotly.min.js" integrity="sha256-oy6Be7Eh6eiQFs5M7oXuPxxm9qbJXEtTpfSI93dW16Q=" crossorigin="anonymous"></script> <script defer src="/assets/js/plotly-setup.js?5e81fc889064852664784cb29c0d6970" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>